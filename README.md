# Восток Транзит  

Основной сайт - https://vostok-transit-gk.ru/  
Тестовый сайт - <укажите url тестового сайта>  
Сайт с версткой - <укажите url сайта с версткой>  

## Как развернуть проект на локальной машине  

**Внимание. Для работы с проектом необходим web server с php 8.1. Для windows подойдет Open server.**  
**Для правильной работы системы сборки фронт-енда нужна node версии 14.15.4**

**1.** Клонировать репозиторий.

> В репозитории присутствуют символические ссылки. Поэтому для windows нужно убедиться, что включена поддержка символических
> ссылок или клонировать репозиторий командой `git clone -c core.symlinks=true <url>`

**2.** Настроить веб сервер для работы с директорией `sites/verstka` для фронт-енд части проекта и `sites/s1` для проекта  на битрикс.  
**3.** composer install (установит зависимости для php).  
**4.** npm install (если нужно работать с фронтенд частью проекта).   
**5.** Скопировать .env.example в .env и установить переменные окружения.  
**6.** Развернуть резервную копию битрикс для бек-енд части проекта.  

## Frontend

### Как запустить систему сборки  

Открыть файл **.env** в корне проекта и установить `MODE="dev"`  
Открыть консоль в корне репозитория и выполнить команду:
```shell script
HOST=http://<url локального сайта> npm run start
```
Сайт откроется автоматически. Теперь при изменении sass или js проект обновляется автоматически

### Как собрать проект

Открыть файл **.env** в корне проекта и установить `MODE="frontend-demonstration"`  
Открыть консоль в корне репозитория и выполнить команду:
```shell script
npm run build
```

Команда соберет проект. Теперь можно открыть <url локального сайта> и посмотреть как сайт будет выглядеть на боевом
сервере.

### Как выполнять задачу и публиковать на боевой сервер

Шаги для Frontend-разработчика:

1. Обновить репозиторий `git pull`;  
2. Создать новую ветку, добавив префикс f/. Пример `git checkout -b f/first-screen-on-homepage`. Можно еще добавлять номер задачи;  
3. Пишем код, создаем атомарные и консистентные коммиты;  
4. Отправляем ветку в Gitea `git push -u origin f/first-screen-on-homepage`;  
5. Создаем pull request, в заголовке пишем что сделали, например "Создает первый экран на главной странице", 
сообщения коммитов подтянутся списком в описание пул-реквеста;  
6. Мерджим pull request, используем стратегию squash, отмечаем галочку "Удалить ветку";  

Шаги для Backend-разработчика:

1. Обновить репозиторий `git pull`;  
2. Создать новую ветку, добавив префикс bx/. Пример `git checkout -b bx/first-screen-on-homepage`. Можно еще добавлять номер задачи;  
3. Пишем код, создаем атомарные и консистентные коммиты;  
4. Отправляем ветку в Gitea `git push -u origin bx/first-screen-on-homepage`;  
5. Создаем pull request, в заголовке пишем что сделали, например "Создает первый экран на главной странице", 
сообщения коммитов подтянутся списком в описание пул-реквеста;  
6. Мерджим pull request, используем стратегию squash, отмечаем галочку "Удалить ветку";

#### Деплой на боевой сервер

Заходим на сервер, переходим в папку с проектом и проверяем, на какой production-ветке работает проект.

Обычно production-ветка называется master или production

1. Переходим в production-ветку и обновляем ее;  
2. С помощью `git merge` переносим коммиты в production-ветку;  
3. Тестируем;  
4. Если есть ошибки, то исправляем и затем коммитим изменения;
5. Если всё ок, то делаем `git push`;
6. Заходим на боевой сервер;
7. Если есть изменения, то коммитим их в production-ветку;
8. Изменений нет? Забираем изменения production-ветки из Gitea, которые залили на п.5;
9. Тестируем на боевом сервере.  

## Бекенд

## Установить битрикс

При установке битрикс следует знать, что планируется хранить ядро в папке bitrix/, а upload в папке upload/ в корне 
репозитория. Символические ссылки на эти директории уже созданы.  

## Бизнес логика

> Здесь стоит описывать новые фичи проекта, если она достаточно сложная
> Это поможем быстро вспомнить как она реализована при поддержке проекта
### Формат описания фичи

<ссылка на задачу>

<Описание словами что делает эта фича>

#### Реализация

<Описание реализации с путями к файлам сайта. Необязательно описывать каждый файл, достаточно основных>
